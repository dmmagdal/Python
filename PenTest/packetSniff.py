# packetSniff.py
# Basic packet sniffer. Code based off blog.
# http://www.bitforestinfo.com/2017/01/how-to-write-simple-packet-sniffer.html
# Python 3.6
# Windows 10

import socket
import platform
import os


def main():
	# Depending on os, create socket.socket object.
	if platform.system() == "Windows":
		createWinSock()
	elif os.name == "posix":
		createLinSock()


def createWinSock():
	s = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_IP)
	#s.bind(("YOUR_INTERFACE_IP", 0))
	#s.setsockopt(socket.IPPROTO_IP, socket.IP_HDRINCL, 1)
	#s.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)
	sniff(s)


def createLinSock():
	#s = socket.socket(socket.PF_PACKET, socket.SOCK_RAW, 
	#					socket.ntohs(0x0800))
	s = socket.socket(socket.AF_INET, socket.SOCK_RAW, 
						socket.IPPROTO_TCP)
	sniff(s)


def sniff(s):
	# Recieve a packet
	while True:
		# Print packet to terminal.
		print(s.recvfrom(65565))


if __name__ == '__main__':
	main()
