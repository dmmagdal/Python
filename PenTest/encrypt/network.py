# network.py
# scans the local network and creates a graph of all devices connected 
# to the network

import networkx as ntwk
import matplotlib as plt
import socket, os, re
from ping2 import *

# Scan the network and collect all ipaddresses into a list

# retrieve device's ipaddress
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s6 = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)
s.connect(('google.com', 0))
s6.connect(('google.com', 0))
ip = s.getsockname()[0]
ip6 = s6.getsockname()[0]
end = re.search('^[\d]{1,3}.[\d]{1,3}.[\d]{1,3}.[\d]{1,3}', ip)
end6 = re.search('^[\d]{1,3}.[\d]{1,3}.[\d]{1,3}.[\d]{1,3}.[\d]{1,3}.[\d]{1,3}', ip6)
print("IPv4 Address "+str(end.group(0)))
print("IPv6 Address "+str(end6.group(0)))

# find all other ipadresses on the network

# ping an ip
def ping(ip):
	if verbose_ping(ip) == True:
		print("%s is online.", str(ip))

# check ip
def checkLoopBack(ip):
	if end.group(0) == '127.0.0.1':
		print("Either your ip address is a loop back or it does not belong in local ip range")
	else:
		for i in range(1, 244):
			ping(str(create_ip.group(0)) + str(i))
		os.system('clear')